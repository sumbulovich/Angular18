<mat-card appearance="outlined" class="mb-4 w-full">
  <mat-card-header class="items-center py-3">
    <mat-icon mat-card-avatar class="mb-0">task</mat-icon>
    <mat-card-title>Support tickets</mat-card-title>
    @if (!ticketsStore.isEditing()) {
    <button mat-flat-button [routerLink]="['new']">Add Ticket</button>
    }
  </mat-card-header>
  <mat-card-content [class.!p-0]="ticketsStore.entities().length && !ticketsStore.isEditing()">
    <router-outlet></router-outlet>
    @if (!ticketsStore.isEditing()) {
    <mat-accordion>
      @for (ticket of ticketsStore.entities(); track ticket._id) {
      @if ($first) {
      <mat-divider></mat-divider>
      }
      <app-ticket [ticket]="ticket" [className]="$even ? 'bg-primary/[.3]' : 'bg-primary/[.1]'"
        (close)="closeTicket(ticket)" (delete)="deleteTicket(ticket)"></app-ticket>
      @if ($last) {
      <mat-divider></mat-divider>
      }
      } @empty {
      <p class="px-3">No tickets available</p>
      }
    </mat-accordion>
    <mat-card-actions align="end">
      <mat-paginator [length]="ticketsStore.pageEvent().length" [pageSize]="ticketsStore.pageEvent().pageSize"
        [pageIndex]="ticketsStore.pageEvent().pageIndex" [pageSizeOptions]="[5, 10, 25, 100]"
        (page)="loadTickets($event)">
      </mat-paginator>
    </mat-card-actions>
    }
  </mat-card-content>
</mat-card>
